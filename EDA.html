<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Introduction.html">Introduction</a>
</li>
<li>
  <a href="Imputation.html">Data</a>
</li>
<li>
  <a href="EDA.html">EDA</a>
</li>
<li>
  <a href="analysis.html">Prelimary Analysis</a>
</li>
<li>
  <a href="Linear_Regression_Model.html">Regression</a>
</li>
<li>
  <a href="Conclusion.html">Conclusion</a>
</li>
<li>
  <a href="https://7lx8uo-txbrook.shinyapps.io/map_dashboard/#section-life-expectancy">Shiny App</a>
</li>
<li>
  <a href="Project-report.html">Report</a>
</li>
<li>
  <a href="mailto:sx2337@cumc.columbia.edu?subject=About%20your%20website">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/ShunXie/SX.github.io/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exploratory Data Analysis</h1>

</div>


 
 
<div id="shiny-app" class="section level1">
<h1>Shiny App</h1>
<p>Life expectancy as well as other included variables changes over
decades. A way of seeing the trend is via shiny app <a
href="https://7lx8uo-txbrook.shinyapps.io/map_dashboard/#section-current-health-expenditure">here</a>
developed by our teammate, which illustrates the life expectancy for
individual countries in the world wide scale. A screen shot is as
following:</p>
<p><img src="images/shiny_app.png" /></p>
 
 
 
</div>
<div id="time-series-plot" class="section level1">
<h1>Time series plot</h1>
<p>With our existence data, we need to evaluate the overall trend with
respect to different types of countries. One way to differentiate
country is to identify that whether the country is classified as
developed or developing country. In the work by <a
href="https://www.journals.uchicago.edu/doi/pdf/10.1086/451180?casa_token=9gJkljIq_ukAAAAA:j3C4Kv-0Jp_gUpmVKvxFAxT1oGg8ryzRaHR_hdBX7QlqrAPGKU36A43QBGZ65AItaKU-LrLn6NE">SP
Heyneman</a>, he claimed that the change of economic status and school
has a big difference between developed and developing country. We treat
these variables as our predictors to the life expectancy. Therefore, it
is likely that the predictors are different between developed and
developing country. On the other hand, people with different income have
different life expectancy. According to <a
href="https://jamanetwork.com/journals/jama/article-abstract/2513561">Chatty
et. al.</a>, the richest 1% income group has a 14.6 years and 10.1 years
higher life expectancy for men and women respectively against the
poorest 1% of income group. Therefore, we plot the trends for different
variables over time with respect to development of the country and
income group of the country.</p>
<pre class="r"><code>merged_data = 
  read_csv(&quot;data/Merged_expectation.csv&quot;, show_col_types = FALSE)

imputed_data = read_csv(&quot;data/Imputed_expectation.csv&quot;, show_col_types = FALSE)</code></pre>
<pre class="r"><code>Time_series_plot = function(variable,merged_data){
  merged_data %&gt;% 
  group_by(year, `Developed / Developing Countries`) %&gt;% 
  summarize_at(variable,mean,na.rm=TRUE) %&gt;% 
  pivot_wider(
    values_from = variable,
    names_from = `Developed / Developing Countries`
  ) %&gt;% 
  ggplot()+
  geom_line(aes(x=year, y=Developed, color=&#39;a&#39;))+
  geom_line(aes(x=year, y=Developing, color=&#39;b&#39;))+
  scale_color_manual(name = &#39; &#39;, 
                     values =c(&quot;a&quot;=&#39;black&#39;,&quot;b&quot;=&#39;red&#39;), 
                     labels = c(&#39;Developed&#39;,&#39;Developing&#39;))+
  geom_point(aes(x=year, y=Developed, color=&#39;a&#39;),shape=19,size = 3)+
  geom_point(aes(x=year, y=Developing, color=&#39;b&#39;),color = &quot;red&quot;, shape=19,size = 3)+
  labs(title = sprintf(&quot;Time series plot for %s (develop)&quot;, variable) )+
  xlab(&quot;Year&quot;)+
  ylab(sprintf(&quot;%s&quot;,variable))
}


Time_series_income =  function(variable,merged_data){
  merged_data %&gt;% 
  group_by(year, income_group) %&gt;% 
  summarize_at(variable,mean,na.rm=TRUE) %&gt;% 
  pivot_wider(
    values_from = variable,
    names_from = income_group
  ) %&gt;% 
  janitor::clean_names() %&gt;% 
  ggplot()+
  geom_line(aes(x=year, y=high_income, color=&#39;a&#39;))+
  geom_line(aes(x=year, y=upper_middle_income, color=&#39;b&#39;))+
  geom_line(aes(x=year, y=lower_middle_income, color=&#39;c&#39;))+
  geom_line(aes(x=year, y=low_income, color=&#39;d&#39;))+
  scale_color_manual(name = &#39; &#39;, 
                     values =c(&quot;a&quot;=&#39;black&#39;,&quot;b&quot;=&#39;red&#39;,&quot;c&quot;=&#39;blue&#39;,&quot;d&quot;=&#39;purple&#39;), 
                     labels = c(&#39;High&#39;,&#39;Upper middle&#39;,&#39;Lower middle&#39;,&#39;Low&#39;))+
  geom_point(aes(x=year, y=high_income, color=&#39;a&#39;),shape=19,size = 3)+
  geom_point(aes(x=year, y=upper_middle_income, color=&#39;b&#39;),color = &quot;red&quot;, shape=19,size = 3)+
  geom_point(aes(x=year, y=lower_middle_income, color=&#39;c&#39;),color = &quot;blue&quot;, shape=19,size = 3)+
  geom_point(aes(x=year, y=low_income, color=&#39;d&#39;),color = &quot;purple&quot;, shape=19,size = 3)+
  labs(title = sprintf(&quot;Time series plot for %s (income)&quot;, variable) )+
  xlab(&quot;Year&quot;)+
  ylab(sprintf(&quot;%s&quot;,variable))
}

ts1 = Time_series_plot(&quot;une_life&quot;,merged_data)
ts2 = Time_series_income(&quot;une_life&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-2-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Life expectancy as our dependent variable has similar trends for both
developed and developing countries. Two life expectancy indices have a
persistent increase over time. However, the expectancy for developed
countries is 10 years higher than the developing countries over 16
years. The similar trends also holds for different income groups but
countries classified in low income group has a higher growth rate for
life expectancy than other groups.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;adult_mortality&quot;,merged_data)
ts2 = Time_series_income(&quot;adult_mortality&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-3-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Adult mortality has a similar trend with life expectancy, but in a
reversed order. The mortality rate in developing and low income
countries decreases with a higher rate than developed and high income
countries.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;alcohol&quot;,merged_data)
ts2 = Time_series_income(&quot;alcohol&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-4-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Alcohol seems to have a stable trends for all countries. However,
alcohol consuption in developed countries have a much higher value than
developing country, and countries classified as high and upper middle
income have a higher alcohol consuption value than lower middle and low
income, where countries in the latter two two categories have a value of
2 bottles per capita.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;bmi&quot;,merged_data)
ts2 = Time_series_income(&quot;bmi&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Over years, bmi for most of countries increases and countries in
different categories all increases regardless of development and income
group of the country. Interestingly, upper middle income countries
exceed the bmi for high income countries, whereas low income countries
has a by far lower value than other countries. Also, developing
countries has a higher rate of increase as indicated by a steeper line
(higher tangent) according to the time series plot.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;measles&quot;,merged_data)
ts2 = Time_series_income(&quot;measles&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Measles vaccination coverage increases for developing countries and
developed countries have a persistently high vaccination coverage. On
the other hand, developing countries and low income countries has a soar
in vaccination coverage over the time period.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;age5_19obesity&quot;,merged_data)
ts2 = Time_series_income(&quot;age5_19obesity&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-7-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Although due to the development over time period, the problem obesity
worsen and increases over all countries. Upper middle income and
developing countries have a higher increase in obesity rate.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;basic_water&quot;,merged_data)
ts2 = Time_series_income(&quot;basic_water&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Time series plot for basic water indicates an increase in percentage
of people getting basic water over time for developing and lower income
countries. On the other hand, high income and developed countries have a
constant high basic water coverage.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;doctors&quot;,merged_data)
ts2 = Time_series_income(&quot;doctors&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-9-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Time series plot for doctors per 10,000 people has interesting
trends. Despite the constant increase in high income countries and
developed countries, other countries seems to have a fluctuation over
the period. There is a sudden decrease in 2004 where SARS explodes. As a
result by <a href="https://www.mdpi.com/1648-9144/57/4/325">Magdalena
et. al.</a>, there are 48.94% of the doctors treated infected patients
and 7.4% of the doctors were confirmed infected during the first 6 month
period. This could potentially lead to death of doctors in lower middle
income, low income and developing countries.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;une_edu_spend&quot;,merged_data)
ts2 = Time_series_income(&quot;une_edu_spend&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-10-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Education expenditure for all countries varies. High and developed
countries have the highest expenditure among all countries over all
years.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;une_gni&quot;,merged_data)
ts2 = Time_series_income(&quot;une_gni&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-11-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The gni is different for developed and developing country over the
year. While developing countries have a relative stable curve at 10000
dollar per capita, developed countries increases from 20000 dollar to
40000 dollar per capita. On the other hand, gni per capita for high
income countries, which exceeds 40000 dollar per capita in year 2013,
have by far the highest value among other countries.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;une_pop&quot;,merged_data)
ts2 = Time_series_income(&quot;une_pop&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The population in developing countries is much higher than population
in developed countries. Interestingly, when we consider the population
among different income groups, we can see that lower middle income
countries have the highest population, whereas low income countries and
high income countries both have value around 20,000,000.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;une_literacy&quot;,merged_data)
ts2 = Time_series_income(&quot;une_literacy&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The literacy coverage has some missing value. In particular, all
developed countries have a missing value in year 2006. But as indicated
in the plots, literacy coverage is higher in developed and high income
countries. Additionally, developing countries have an increasing trend
in literacy whereas low income countries have a fluctuation but a non
increasing or decreasing trend.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;PM_value&quot;,merged_data)
ts2 = Time_series_income(&quot;PM_value&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-14-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Consider only non-missing data, PM value decreases for high and
developed countries. The countries with low and lower middle income have
a persistent high PM value over the periods, with approximately 100
percentage of total population exposed to levels exceeding WHO guideline
value.</p>
<pre class="r"><code>ts1 = Time_series_plot(&quot;gghe_d&quot;,merged_data)
ts2 = Time_series_income(&quot;gghe_d&quot;,merged_data)
plot_grid(ts1, ts2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-15-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Health expenditure in developed countries soar over the years from
2000 to 2016, from 4% to 5% of total GDP. Developing countries also have
an increase in the health expenditure, but with a lower rate. For
different income level, high income countries have the highest
expenditure on health and it has an increasing trend. However, health
expenditure measured in percentage of GDP decreases among low income
countries.</p>
<p><br> <br></p>
</div>
<div id="multi-colinearity-check" class="section level1">
<h1>Multi-colinearity Check</h1>
<p>First, we shall check the multi-colinearity between predictors. This
is because multi-colinearity can cause huge swing in coefficient
estimates and reduce the precision of estimated coefficients (<a
href="https://statisticsbyjim.com/regression/multicollinearity-in-regression-analysis/">ref</a>).
The correlation heat map is able to help us identify the existence of
multi-colinearity among chosen predictors.</p>
<pre class="r"><code>mortality_correlation = merged_data %&gt;% 
  select(adult_mortality, infant_mort, age1_4mort, une_life)
res = cor(mortality_correlation)
corrplot(res, type = &quot;upper&quot;, order = &quot;hclust&quot;, 
         tl.col = &quot;black&quot;, tl.srt = 45)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>heat map shows that the chosen factors, namely mortality,
life_expectancy are very correlated. Mortality is negatively correlated
to une life expectancy and it is directly correlated to infant mortality
and mortality for children from age 1 to 4. This may because life
expectancy is calculated based on mortality rate. Although linear
relation can perfectly explain the two relation, it is not a good idea
to include such variable as it is directly a variable for calculating
life expectancy. Therefore, it is not a good idea to include mortality
as our predictor.</p>
<pre class="r"><code>disease_correlation = merged_data %&gt;% 
  select(hepatitis, measles, polio, diphtheria) %&gt;% 
  na.omit()

res = cor(disease_correlation)
res</code></pre>
<pre><code>##            hepatitis measles polio diphtheria
## hepatitis       1.00    0.68  0.69       0.72
## measles         0.68    1.00  0.90       0.89
## polio           0.69    0.90  1.00       0.96
## diphtheria      0.72    0.89  0.96       1.00</code></pre>
<pre class="r"><code>corrplot(res, type = &quot;upper&quot;, order = &quot;hclust&quot;, 
         tl.col = &quot;black&quot;, tl.srt = 45)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In our dataset, we have a lot of vaccinations for different diseases.
Therefore, it is natural to check whether the vaccinations data are
correlated to each other. It seems like they are all very correlated to
each other, with correlation value higher than 0.6. In consequence, we
decide to only choose vaccinations for measles as our chosen vector as
it was one of the most common disease and now almost fully controled by
vaccination. There is still some cases remain for the people that did
not get vaccinated according to <a
href="https://www.cdc.gov/measles/cases-outbreaks.html">CDC
website</a>.</p>
<pre class="r"><code>obe_thin_correlation = merged_data %&gt;% 
  select(age5_19thinness, age5_19obesity,bmi) %&gt;% 
  na.omit()
res = cor(obe_thin_correlation)
res</code></pre>
<pre><code>##                 age5_19thinness age5_19obesity   bmi
## age5_19thinness            1.00          -0.55 -0.69
## age5_19obesity            -0.55           1.00  0.81
## bmi                       -0.69           0.81  1.00</code></pre>
<pre class="r"><code>corrplot(res, type = &quot;upper&quot;, order = &quot;hclust&quot;, 
         tl.col = &quot;black&quot;, tl.srt = 45)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>BMI, Thinness and obesity are three variables measuring similar
characteristics. Ideally, people that are thinner, is less likely to
have obesity and a lower bmi value. Therefore, I make corelation heat
map and it turns out that the three variables are quite correlated, with
a value around -0.55. For the prevention of multi-colinearity, I choose
bmi only in our analysis as it is more meaningful. A BMI value greater
than 25 is classified as obesity based on <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4890841/">BMI
Journal</a> and it is one of the problem that exists among people.
Cardiomyopathy, for instance, is one of the leading problem due to
obesity in recent years by <a
href="https://www.tandfonline.com/doi/full/10.1586/14779072.2014.952283">Benoit
et. al.</a>. Thus, we want to figure out if bmi can be used to predict
life expectancy and whether a high bmi do lead to a decrease in life
expectancy.</p>
<p><br> <br></p>
</div>
<div id="correlation-and-scatter-plot" class="section level1">
<h1>Correlation and Scatter Plot:</h1>
<p>Visualization via scatter plot is a way to further discover the
pairwise relation between two chosen variable. By plotting the scatter
plot and fitted using best linear line, we can potential obtain the
relationship between variables and how well linear trend can explain the
data. Since we choose Life expectancy as our response variable, we can
plot the scatter plot between life expectancy and other chosen
predictors to see the correlation between variables.</p>
<pre class="r"><code># alcohol
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, alcohol) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = alcohol, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and alcohol&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-19-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Among four years, the trend of relation between life expectancy and
alcohol are similar. Although the line of best fit split points into an
evenly two parts, there are more points with low alcohol values. And
linear trend may not fully explain such relation.</p>
<pre class="r"><code>#bmi
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, bmi) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = bmi, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and bmi&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-20-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Bmi has a positive correlation with life expectancy as shown in the
plots, and the points for the four years are almost exactly the same.
Linear trend seems to explain the relation well as suggested in the
scatter plots. When bmi increases, the life expectancy is likely to have
a higher value, although we cannot check the causation in behind.</p>
<pre class="r"><code>#measles
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, measles) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = measles, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and measles&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-21-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Measle vaccination coverage seems to indicate a high life expectancy
when vaccination coverage is high. But such relation may be non linear
as there are lots of values clustered in the upper right corner.</p>
<pre class="r"><code>#obesity
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, age5_19obesity) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = age5_19obesity, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and obesity among age 5-19&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-22-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Although linear trend works well in the scatter plot between obesity
and life expectancy, the points suggests a non-linear, perhaps a
quadratic trends, in the graph. There is clearly a “r” shape pattern in
the graph. Similar to other plots, the four years have almost the same
scatter plot.</p>
<pre class="r"><code>#basic_water
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, basic_water) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = basic_water, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and percentag of people access to basic water &quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-23-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Linear trends fit the relation between Life Expectancy and percentag
of people access to basic water well. There is clearly an upward
increasing trend.</p>
<pre class="r"><code># doctors
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, doctors) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = doctors, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and doctors&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-24-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Similar to obesity, the graph has a “r” pattern and thus, there exist
a non linear correlation. Thus, linear relation may not be accurate to
explain the association. However, the linear trend do include most of
the information, so it might be sufficient to just use linear relation.
We will check it further in later analysis.</p>
<pre class="r"><code>#une_edu_spend
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, une_edu_spend) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = une_edu_spend, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and education expenditure&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-25-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The expenditure also suggest a linear increasing trend for all years.
Year 2015 seems to have an outlier with a very high education
expenditure. Otherwise, the pattern is similar for the four years. The
scatter plot is quite spread out, so there may be some indication of non
linear trend but we cannot conclude from the scatter plot.</p>
<pre class="r"><code># une_gni
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, une_gni) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = une_gni, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and GNI per capita&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-26-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The association between life expectancy and GNI per capita also shows
a non-linear correlation with a “r” patter. Therefore, non-linear
correlation analysis may be needed.</p>
<pre class="r"><code>#une_pop
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, une_pop) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = une_pop, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and Population&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-27-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>As seen in the scatter plot, population is not very correlated to
life expectancy and the data are very focused on low population. A
linear relation is not quite appropriate here.</p>
<pre class="r"><code>#une_literacy
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, une_literacy) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = une_literacy, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and Literacy Coverage&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-28-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Due to the missing values, literacy coverage does not have a lot of
details. But linear trend do explain the over all association between
life expectancy and percentage of people who are able to write and speak
a language.</p>
<pre class="r"><code># PM_value
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, PM_value) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = PM_value, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and percentage of people exposed to abnormal PM level&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-29-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Since most of people are exposed to abnormal PM level, most of the PM
value is clustered at 100. Linear relation may be sufficient to explain
lower PM values but it may be difficult to include all the information
for high PM value.</p>
<pre class="r"><code>#gghe_d
merged_data_temp =
merged_data %&gt;% 
  select(year, une_life, gghe_d) %&gt;% 
  filter(year &gt; 2012)



myplots &lt;- vector(&#39;list&#39;, 4)
for (i in 2013:2016){
    myplots[[i-2012]] =
      merged_data_temp %&gt;% 
      filter(year == i) %&gt;% 
      ggplot(aes(x = gghe_d, y = une_life))+geom_point()+geom_smooth(method = &#39;lm&#39;, se = TRUE, color = &#39;red&#39;)+
      labs(title = sprintf(&quot;year %s&quot;, i))
  
  }
  
plot_row1 &lt;- plot_grid(myplots[[1]], myplots[[2]])
plot_row2 &lt;- plot_grid(myplots[[3]], myplots[[4]])
# title
title &lt;- ggdraw() + 
  draw_label(
    &quot;Scatter Plot for Life Expectancy and Health expenditure&quot;,
    fontface = &#39;bold&#39;,
    x = 0,
    hjust = 0
  ) +
  theme(
    # add margin on the left of the drawing canvas,
    # so title is aligned with left edge of first plot
    plot.margin = margin(0, 0, 0, 7)
  )


plot_grid(title,plot_row1,plot_row2 ,ncol=1,  label_size = 12,rel_heights=c(0.1, 1,1))</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-30-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Health expenditure is positively correlated with life expectancy.
However, there may be non linear trend as there is a curve bending at
health expenditure = 3% of GDP.</p>
<p><br> <br></p>
</div>
<div id="correlation" class="section level1">
<h1>Correlation:</h1>
<p>Although scatter plot gives us some visualization of correlation
between variables, we can not know to what extend the two variables are
correlated. Therefore, correlation, as a numeric value, is of a great
help to resolve the problem. The correlation value gives us a value that
indicates how correlated two variables are using Pearson method or
distance methods.</p>
<p><br></p>
<div id="pearson-correlation" class="section level2">
<h2>Pearson Correlation</h2>
<div id="theory" class="section level3">
<h3>Theory</h3>
<p>Pearson correlation is a common EDA method that measures the strength
of the linear relation between two variables <a
href="https://link.springer.com/chapter/10.1007/978-3-642-00296-0_5">paper</a>.
It has the formula defined in following definition:</p>
 
</div>
<div id="definition-pearson" class="section level3">
<h3>Definition Pearson</h3>
<p>Let x and y be two random variables with zero mean and <span
class="math inline">\(x,y\in \mathbb R\)</span>, the pearson correlation
coefficient is defined as:</p>
<p><span class="math display">\[
\rho (x,y) = \frac{cov(x,y)}{\sigma_x\sigma_y}
\]</span></p>
<p>where <span class="math inline">\(\sigma_x=\sqrt{var(x)}\)</span> and
<span class="math inline">\(\sigma_y=\sqrt{var(y)}\)</span>.</p>
<p><br> <br></p>
<p>The coefficient as a value between <span
class="math inline">\(-1\leq\rho(x,y)\leq1\)</span>. If the coefficient
is zero, then x and y does not have correlation at all. If the
coefficient is closer to a value of +1 or -1, then the correlation
between the two variable is stronger. A +1 coefficient means the two
variables have a perfect positive correlation whereas a -1 value means
the two variables have a perfect negative correlation.</p>
 
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<p>Over the time:</p>
<pre class="r"><code>Pearson_Correlation = function(varnum, merged_data){
  
  correlation_result = tibble(&quot;date&quot;=2000:2016, &quot;Pearson_cor&quot;=0,&quot;Pearson_pval&quot;=0)
  
  for (t in 2000:2016){
    merged_data_temp = 
      merged_data %&gt;% 
      filter(year==t)
    
    correlation_result$Pearson_cor[t-1999] = 
    round(cor(merged_data_temp[,varnum], merged_data_temp$une_life, method = &quot;pearson&quot;,use = &quot;complete.obs&quot;)[1],2)
    
    correlation_result$Pearson_pval[t-1999] = 
    round(cor.test(merged_data_temp[,varnum][[1]], merged_data_temp$une_life, method = &quot;pearson&quot;,use = &quot;complete.obs&quot;)$p.value,2)
    
  }
  
  return(correlation_result)
  
}

#Pearson_Correlation(6,merged_data)

Pearson_Correlation_result = tibble(&quot;date&quot;=2000:2016)


colname = colnames(merged_data)



Pearson_Corr_res = 
Pearson_Correlation_result %&gt;%
  mutate(mortality = Pearson_Correlation(8,merged_data)$Pearson_cor,
         alcohol = Pearson_Correlation(11,merged_data)$Pearson_cor,
         bmi = Pearson_Correlation(12,merged_data)$Pearson_cor,
         obesity = Pearson_Correlation(14,merged_data)$Pearson_cor,
         measles = Pearson_Correlation(16,merged_data)$Pearson_cor,
         water = Pearson_Correlation(19,merged_data)$Pearson_cor,
         doctors = Pearson_Correlation(20,merged_data)$Pearson_cor,
         )

Pearson_Corr_res2 = 
Pearson_Correlation_result %&gt;%
  mutate(edu_expenditure = Pearson_Correlation(31,merged_data)$Pearson_cor,
         gni_capita = Pearson_Correlation(29,merged_data)$Pearson_cor,
         population = Pearson_Correlation(25,merged_data)$Pearson_cor,
         literacy = Pearson_Correlation(32,merged_data)$Pearson_cor,
         #PM_value = Pearson_Correlation(34,merged_data)$Pearson_cor,
         health_expenditure = Pearson_Correlation(23,merged_data)$Pearson_cor)

Pearson_Corr_pval = 
Pearson_Correlation_result %&gt;%
  mutate(mortality = Pearson_Correlation(8,merged_data)$Pearson_pval,
         alcohol = Pearson_Correlation(11,merged_data)$Pearson_pval,
         bmi = Pearson_Correlation(12,merged_data)$Pearson_pval,
         obesity = Pearson_Correlation(14,merged_data)$Pearson_pval,
         measles = Pearson_Correlation(16,merged_data)$Pearson_pval,
         water = Pearson_Correlation(19,merged_data)$Pearson_pval,
         doctors = Pearson_Correlation(20,merged_data)$Pearson_pval,
         edu_expenditure = Pearson_Correlation(31,merged_data)$Pearson_pval,
         gni_capita = Pearson_Correlation(29,merged_data)$Pearson_pval,
         population = Pearson_Correlation(25,merged_data)$Pearson_pval,
         literacy = Pearson_Correlation(32,merged_data)$Pearson_pval,
         #PM_value = Pearson_Correlation(34,merged_data)$Pearson_pval,
         health_expenditure = Pearson_Correlation(23,merged_data)$Pearson_pval
         )
         

grid.table(Pearson_Corr_res)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>grid.table(Pearson_Corr_res2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>As indicated in the table, bmi, obesity, measles vaccination, gni per
capita and health expenditure all have a high correlation with life
expectancy, with a value close to 0.6. The correlation with water access
and literacy is even higher, over 0.8 for all years. As discussed, life
expectancy is calculated from mortality and therefore it has a really
high correlation. We will not include such data. On the other hand,
population is not likely to be correlated with life expectancy, as the
correlations are all approximately 0.03.</p>
<p><br> <br></p>
</div>
</div>
<div id="distance-correlation" class="section level2">
<h2>Distance Correlation</h2>
<div id="theory-1" class="section level3">
<h3>Theory</h3>
<p>Although Pearson Correlation may be sufficient to explore the
association between variables and life expectancy, there is some
non-linear trends exist between variables, such as obesity, GNI per
capita, doctors, health expenditure, and life expectancy. Therefore, it
is necessary to use a non-linear method to account for such
scenarios.</p>
<p>Distance correlation is a novel developed technique to discover the
joint dependence of random variables developed by <a
href="https://projecteuclid.org/journals/annals-of-statistics/volume-35/issue-6/Measuring-and-testing-dependence-by-correlation-of-distances/10.1214/009053607000000505.full">Székely
et al</a>. Unlike Pearson correlation, such Pairwise distance
correlation is a distance method and therefore it can take into
consideration of the non-linear relationship between two random
variables, namely <span class="math inline">\(X\in \mathbb{R}^p\)</span>
and <span class="math inline">\(Y\in \mathbb{R}^q\)</span> that can have
arbitrary dimensions (p and q can be non-equal) to some extend. The
correlation between two variables is said to be independent of distance
correlation <span class="math inline">\(\mathcal{R}(X,Y)=0\)</span>.</p>
<p>Denote the scalar product of two vectors <span
class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span> as &lt;<span
class="math inline">\(a,b\)</span>&gt; and conjugate of complex function
f as <span class="math inline">\(f\)</span>. Also define norm <span
class="math inline">\(|x|_p\)</span> as Euclidean norm for <span
class="math inline">\(x\in\mathbb{R}^p\)</span></p>
<p><br> <br></p>
<div id="definition-1" class="section level4">
<h4>Definition 1</h4>
<p>In weighted <span class="math inline">\(l_2\)</span> space, the <span
class="math inline">\(||\cdot||_w\)</span>-norm for any complex function
<span class="math inline">\(\zeta \in
\mathbb{R}^p\times\mathbb{R}^q\)</span> is defined by: <span
class="math display">\[
\begin{equation}
    ||\zeta( a, b )||^2
_w =\int_{\mathbb{R}^{p+q}}|\zeta( a, b)|^2 w( a, b)\,d a\, d b
\end{equation}
\]</span> where <span class="math inline">\(w(a,b)\)</span> can be any
arbitrary positive weighting function as long as the integral is
well-defined.</p>
<p><br> <br></p>
</div>
<div id="definition-2" class="section level4">
<h4>Definition 2</h4>
<p>Define the measure of dependence as: <span class="math display">\[
\begin{equation}
V^2(X,Y;w) = ||f_{X,Y}(a,b)-f_X(a)f_Y(b)||^2_w=
\int_{\mathbb{R}^{p+q}}|f_{X,Y}(a,b)-f_X(a)f_Y(b)|^2 w( a, b)\,d a\, d b
\end{equation}
\]</span></p>
</div>
<div id="proof" class="section level4">
<h4>Proof</h4>
<p><em>The criterion of independent means that for vectors <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, the probability density function <span
class="math inline">\(f_X(a)\)</span>, <span
class="math inline">\(f_Y(b)\)</span> and their joint probability
density function <span class="math inline">\(f_{X,Y}(a,b)\)</span>
satisfies <span
class="math inline">\(f_{X,Y}(a,b)=f_X(a)f_Y(b)\)</span>. Therefore, I
have <span class="math inline">\(V^2(X,Y;w)=||0||^2_w=0\)</span> if they
are independent hence the equation satisfy the condition that <span
class="math inline">\(V^2=0\)</span> only if variables are independent.
(see <a
href="https://d1wqtxts1xzle7.cloudfront.net/61217354/solucionario_estadistica_papoulis20191114-47174-4f1occ-with-cover-page-v2.pdf?Expires=1669433644&amp;Signature=PaZvHQ0E9kQ6FyxALEPJ5A1LFgJ3-4zYvgbzSUP7obp~cfIuvZe~8QTXle4i6usOg6MOXKs-KkOUzwVgAz60n4dm5r595qPuZPhzyfu9pE~2hydHWubyH8dfZa-59DF07O3hPFdPgPDrvSGiOWFtfuD2HXBXN2IQ4nm~UJ94pPMG7K8q0jh4WYqDp7WbQ-9WQ5hFULnUKGIH2ok7rwAFEbHqMBR6FAIHJO8gtUjaTtMhc6K4OIAmzBnoqgSOInEE6kXy4agsg1sboDLyxxJMOfJa33GPNRlwrU1Yv69wcb3rsjtjL2s9JGM4mJATS6xpRspz0RBDDZqXSIngfjmE0w__&amp;Key-Pair-Id=APKAJLOHF5GGSLRBV4ZA">paper</a>)</em></p>
<p><br> <br></p>
<p>The choice of weighting function must satisfy invariance under
transformations of random variables up to multiplication of a positive
constant <span class="math inline">\(\epsilon\)</span>: <span
class="math inline">\((X,Y)\rightarrow (\epsilon X, \epsilon Y)\)</span>
and positiveness for any dependent variables. By the work of Szekely et.
al., only non-integrable functions satisfy the condition for weight
function. In order to specify the formula, I need the following
lemma</p>
<p><br> <br></p>
</div>
<div id="lemma-1" class="section level4">
<h4>Lemma 1</h4>
<p>For all x in <span class="math inline">\(\mathbb{R}^d\)</span>: <span
class="math display">\[
\begin{equation}
\int_{\mathbb{R}^d}\frac{1-cos&lt;y,x&gt;
}{|y|^{d+1}_{d}}dy=c_d|x|=\frac{\pi ^{(1+d/2)}}{2 \Gamma ((d+1)/2)}|x|
\end{equation}
\]</span> where <span class="math inline">\(\Gamma(\cdot)\)</span> is
the gamma function. This is proved by <a
href="https://home.ipipan.waw.pl/j.mielniczuk/Szekely-Rizzo_2005.pdf">Szekely
et. al.</a></p>
<p><br> <br></p>
<p>Now I can choose weight function as following: <span
class="math display">\[
\begin{equation}
w(a,b) = (c_p c_q |a|
^{1+p}_p |b|
^{1+q}_q )^{-1}
\end{equation}
\]</span></p>
<p>By using such weight function and lemma 3.1, the definition of
distance covariance will be well-defined. Note by the weight, I have
<span class="math inline">\(dw = (c_p c_q |a| ^{1+p}_p |b| ^{1+q}_q
)^{-1}dadb\)</span>. This is proven in the following definition. \</p>
<p><br> <br></p>
</div>
<div id="definition-4" class="section level4">
<h4>Definition 4</h4>
<p>Define the distance covariance (dCov) for random vectors <span
class="math inline">\(X\)</span> and <span
class="math inline">\(Y\)</span> with finite expectation as the
following non-negative figure: <span class="math display">\[
\begin{equation}
    V^2(X,Y) = ||f_{X,Y} (a,b)- f_X(a)f_Y (b)||^2
= \frac{1}{c_pc_q}\int_{\mathbb{R}^{p+q}}\frac{|f_{X,Y} (a,b) -
f_X(a)f_Y (b)|^2}{|a|^{1+p}_p|b|^{1+q}_q}da db
\end{equation}
\]</span> where <span class="math inline">\(a\in \mathbb{R}^p\)</span>,
<span class="math inline">\(b\in \mathbb{R}^q\)</span> are two vectors
that <span class="math inline">\(a\in X\)</span> and <span
class="math inline">\(b\in Y\)</span></p>
<p><br> <br></p>
<p>Different to the Pearson method, the distance correlation have a
non-negative value as it is a distance method. Therefore, although we
have a better ability to measure non-linear correlation, we cannot
identify the direction of the correlation. In other word, we cannot tell
whether the correlation is positively correlated or negatively
correlated.</p>
<p><br></p>
</div>
</div>
<div id="result" class="section level3">
<h3>Result</h3>
<pre class="r"><code>Distance_Correlation = function(varnum, merged_data){
  
  correlation_result = tibble(&quot;date&quot;=2000:2016, &quot;Distance_cor&quot;=0,&quot;Distance_pval&quot;=0)
  
  for (t in 2000:2016){
    merged_data_temp = 
      merged_data %&gt;% 
      filter(year==t) %&gt;% 
      select(27,varnum) %&gt;% 
      na.omit()
    
    correlation_result$Distance_cor[t-1999] = 
    round(dcor(merged_data_temp[,2], merged_data_temp$une_life,)[1],2)
    
    correlation_result$Distance_pval[t-1999] = 
    round(dcor.test(merged_data_temp[,2][[1]], merged_data_temp$une_life,R=1000)$p.value,2)
    
  }
  
  return(correlation_result)
  
}



Distance_Correlation_result = tibble(&quot;date&quot;=2000:2016)

colname = colnames(merged_data)

result_corr = 
Distance_Correlation_result %&gt;%
  mutate(mortality = Distance_Correlation(8,merged_data)$Distance_cor,
         alcohol = Distance_Correlation(11,merged_data)$Distance_cor,
         bmi = Distance_Correlation(12,merged_data)$Distance_cor,
         obesity = Distance_Correlation(14,merged_data)$Distance_cor,
         measles = Distance_Correlation(16,merged_data)$Distance_cor,
         water = Distance_Correlation(19,merged_data)$Distance_cor,
         doctors = Distance_Correlation(20,merged_data)$Distance_cor,
         )
   

result_corr2 = 
Distance_Correlation_result %&gt;%
  mutate(edu_expenditure = Distance_Correlation(31,merged_data)$Distance_cor,
         gni_capita = Distance_Correlation(29,merged_data)$Distance_cor,
         population = Distance_Correlation(25,merged_data)$Distance_cor,
         literacy = Distance_Correlation(32,merged_data)$Distance_cor,
         #PM_value = Distance_Correlation(34,merged_data)$Distance_cor,
         health_expenditure = Distance_Correlation(23,merged_data)$Distance_cor)


result_pval = 
  Distance_Correlation_result %&gt;%
  mutate(mortality = Distance_Correlation(8,merged_data)$Distance_pval,
         alcohol = Distance_Correlation(11,merged_data)$Distance_pval,
         bmi = Distance_Correlation(12,merged_data)$Distance_pval,
         obesity = Distance_Correlation(14,merged_data)$Distance_pval,
         measles = Distance_Correlation(16,merged_data)$Distance_pval,
         water = Distance_Correlation(19,merged_data)$Distance_pval,
         doctors = Distance_Correlation(20,merged_data)$Distance_pval,
         edu_expenditure = Distance_Correlation(31,merged_data)$Distance_pval,
         gni_capita = Distance_Correlation(29,merged_data)$Distance_pval,
         population = Distance_Correlation(25,merged_data)$Distance_pval,
         literacy = Distance_Correlation(32,merged_data)$Distance_pval,
         #PM_value = Distance_Correlation(34,merged_data)$Distance_pval,
         health_expenditure = Distance_Correlation(23,merged_data)$Distance_pval
         )


grid.table(result_corr)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>grid.table(result_corr2)</code></pre>
<p><img src="EDA_files/figure-html/unnamed-chunk-34-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>After take in consideration of non-linear trend, bmi, obesity,
education expenditure, gni per capita has an average of approximately
0.07 increase in the correlation. Population also increases from 0.03 to
0.1. Such increase is not significant because high correlation values
are still highly correlated. Therefore, it provides some evidence that
linear model may be sufficient to use in our data analysis.</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
