<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Linear Regression Model</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="dashboard.html">Dashboard</a>
</li>
<li>
  <a href="mailto:&lt;you@youremail.com&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/&lt;YOUR_GH_NAME&gt;/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Linear Regression Model</h1>

</div>


<pre class="r"><code>library(tidyverse)
library(dplyr)
library(car)
library(modelr)
library(mgcv)
library(patchwork)</code></pre>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>After our EDA and statistical analysis, we consider to generate a
linear regression to better express the relationship between Life
Expectancy and other variables. In particular, we set une_life as our
response variable and we only look at the year of 2015.</p>
</div>
<div id="dataset-preparation" class="section level1">
<h1>Dataset Preparation</h1>
<p>In the beginnig, to prepare our dataset for multiple linear
regression, we delete mortality related variables, delete une_pop, which
is not a good predictor of life expenctancy, and also delete variables
that have high correlation values presented in EDA section.
Specifically, we use “measles” to be the representative of vaccination
variables–hepatitis, measles, polio, and diphtheria. Moreover, we use
“bmi” to be another representative of age5_19thinness, age5_19obesity,
and bmi.</p>
<p>In the end, we limit the data to year 2015.</p>
<pre class="r"><code>data &lt;-
  read_csv(&quot;data/Merged_expectation.csv&quot;) %&gt;%
  filter(year == 2015) %&gt;% 
  select(alcohol:percent_w_in_lower_house) %&gt;% 
  select(-hepatitis, -polio, -diphtheria, -age5_19thinness, -age5_19obesity, -une_infant, -une_pop) %&gt;% 
  mutate(income_group = as.factor(income_group),
         income_group = relevel(income_group, ref = &quot;Low income&quot;))</code></pre>
</div>
<div id="model-1" class="section level1">
<h1>Model 1</h1>
<p>First, we look at the number of missing data we have on each column,
at year 2015. The table below shows variables that have less than 5%
NA’s.</p>
<pre class="r"><code>NA_table_1 &lt;- data %&gt;% 
  is.na() %&gt;% 
  colSums()
NA_table_1[NA_table_1 &lt;= 10] %&gt;% 
    knitr::kable(col.names = c(&quot;Counts of NA&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Counts of NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alcohol</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">bmi</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">measles</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">basic_water</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">gghe_d</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">che_gdp</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">une_life</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">une_gni</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="left">PM_value</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">income_group</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">Developed / Developing Countries</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">percent_w_in_lower_house</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>Limited to the variables that we have less than 5% NA’s (which is
less than 10 NAs), also exclude variables that have high correlation
value, we could generate our first basic linear model, with selected
variables of alcohol, bmi, measles, basic_water, che_gdp (health
expenditure per gdp, gghe_d is deleted since it represents similar
aspects), une_gni, PM_value, income_group (Developed/Developing
Countries is deleted since it is similar to income_group),
percent_w_in_lower_house, and our response variable of une_life.</p>
<ul>
<li>Model 1: une_life ~ alcohol + bmi + measles + basic_water + che_gdp
+ une_gni + PM_value + income_group * percent_w_in_lower_house</li>
</ul>
<p>The following table shows the distribution of all numerical variables
here.</p>
<pre class="r"><code>colname &lt;- c(&quot;alcohol&quot;, &quot;bmi&quot;, &quot;measles&quot;, &quot;basic_water&quot;, &quot;che_gdp&quot;, &quot;une_gni&quot;, &quot;PM_value&quot;, &quot;percent_w_in_lower_house&quot;)
par(mfrow=c(2, 4))
data_1_a &lt;- data.frame(data)
for (i in 1:8) {
  variable &lt;- data_1_a[colname[i]][ ,1]
  hist(variable, main = paste(&quot;Histogram of&quot;, colname[i], sep = &quot; &quot;), xlab = colname[i])
}</code></pre>
<p><img src="Linear_Regression_Model_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Delete all the NA rows in the data, consider intersection between
income_group and percent_w_in_lower_house, using step function with
backwards direction. Then we generate our first model.</p>
<pre class="r"><code># delete all the Na columns
data_1 &lt;- data %&gt;% 
  select(une_life, alcohol, bmi, measles, basic_water, che_gdp, une_gni, PM_value, income_group, percent_w_in_lower_house) %&gt;% 
  drop_na()</code></pre>
<pre class="r"><code># fit the model one
m &lt;- lm(une_life ~ alcohol + bmi + measles + basic_water + che_gdp + une_gni + PM_value + income_group * percent_w_in_lower_house, data = data_1)
# use stepwise function
m1 &lt;- step(m, direction = &quot;backward&quot;, trace = FALSE)</code></pre>
<pre class="r"><code># create table for regression output
m1 %&gt;%
  summary() %&gt;%
  broom::tidy() %&gt;%
  select(term, estimate, p.value) %&gt;% 
  knitr::kable(
      caption = &quot;Estimate and P-value of Model 1 for Year 2015 Life Expectancy (Income Reference Group is Low Income)&quot;, 
      col.names = c(&quot;Predictor&quot;, &quot;Estimate&quot;, &quot;P-value&quot;),
      digits = 3
  )</code></pre>
<table>
<caption>Estimate and P-value of Model 1 for Year 2015 Life Expectancy
(Income Reference Group is Low Income)</caption>
<colgroup>
<col width="77%" />
<col width="12%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Predictor</th>
<th align="right">Estimate</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">37.297</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">alcohol</td>
<td align="right">-0.164</td>
<td align="right">0.102</td>
</tr>
<tr class="odd">
<td align="left">measles</td>
<td align="right">0.066</td>
<td align="right">0.035</td>
</tr>
<tr class="even">
<td align="left">basic_water</td>
<td align="right">0.271</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">income_groupHigh income</td>
<td align="right">6.368</td>
<td align="right">0.009</td>
</tr>
<tr class="even">
<td align="left">income_groupLower middle income</td>
<td align="right">3.437</td>
<td align="right">0.068</td>
</tr>
<tr class="odd">
<td align="left">income_groupUpper middle income</td>
<td align="right">4.358</td>
<td align="right">0.065</td>
</tr>
<tr class="even">
<td align="left">percent_w_in_lower_house</td>
<td align="right">0.156</td>
<td align="right">0.012</td>
</tr>
<tr class="odd">
<td align="left">income_groupHigh income:percent_w_in_lower_house</td>
<td align="right">-0.003</td>
<td align="right">0.973</td>
</tr>
<tr class="even">
<td align="left">income_groupLower middle
income:percent_w_in_lower_house</td>
<td align="right">-0.151</td>
<td align="right">0.041</td>
</tr>
<tr class="odd">
<td align="left">income_groupUpper middle
income:percent_w_in_lower_house</td>
<td align="right">-0.152</td>
<td align="right">0.054</td>
</tr>
</tbody>
</table>
<p>From the above, variables like bmi, che_gdp, une_gni, PM_value are
deleted according to backwards step function. One way to explain this is
that these variables have high correlation with income_group–in higher
income countries(une_gni), people have more access to healthy foods and
healthy life styles (bmi), governments also spend more money on public
health(che_gdp), as well as on building a clean
environment(PM_value).</p>
<p>Another thing that needs to be aware of is that the intersection of
income group and women in parliament(percent_w_in_lower_house). The
variable percent_w_in_lower_house is significant itself, but it is more
significant in middle income and upper income groups. In other words,
after a country reaches a certain level of income, increasing women’s
voice in the country actually helps people live longer, which follows
the intention that we chose to include this variable in the first place.
(Since 0.156 - 0.152 &gt; 0, keeping other variables constant,
percent_w_in_lower_house increases, the predicted life expectancy will
increase.)</p>
<p>The model 1’s R-adjusted score reaches 0.7808107.</p>
<p>Below are the analysis plots of the model. These plot shows that the
residuals are normally distributed, independent, but may not have a
constant variance–it has a linear trend in the end according to the
third plot. In second plot, the points follows the line, so the
regression function is linear. Therefore, maybe we don’t need to add
transformation to our response variable.</p>
<pre class="r"><code>par(mfrow=c(2,2))
plot(m1)</code></pre>
<p><img src="Linear_Regression_Model_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ul>
<li>The final Model 1 is une_life ~ alcohol + measles + basic_water +
income_group * percent_w_in_lower_house</li>
</ul>
</div>
<div id="model-2" class="section level1">
<h1>Model 2</h1>
<p>Second, we only look at the countries with existing une_literacy data
and found out the number of NA in other variables of these countries, at
year 2015. The table below shows variables that have less than 5%
NA’s.</p>
<pre class="r"><code>NA_table_2 &lt;- data %&gt;% 
  filter(is.na(une_literacy) == FALSE) %&gt;% 
  is.na() %&gt;% 
  colSums()
NA_table_2[NA_table_2 &lt;= 3] %&gt;% 
    knitr::kable(col.names = c(&quot;Counts of NA&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Counts of NA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alcohol</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">bmi</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">measles</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">basic_water</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">gghe_d</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">che_gdp</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">une_life</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">une_gni</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">une_literacy</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">PM_value</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">income_group</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Developed / Developing Countries</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">percent_w_in_lower_house</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>Here, limited to the variable that we have less than 5% NA’s (which
is less than 3 NAs), also exclude variables that have high correlation
value, we could generate our second basic linear model, with selected
variables of alcohol, bmi, measles, basic_water, che_gdp, une_gni,
une_literacy, PM_value, income_group, percent_w_in_lower_house, and our
response variable of une_life.</p>
<ul>
<li>Model 2: une_life ~ alcohol + bmi + measles + basic_water + che_gdp
+ une_gni + une_literacy + PM_value + income_group +
percent_w_in_lower_house + income_group * percent_w_in_lower_house</li>
</ul>
<p>(Also consider intersection here)</p>
<p>The following table shows the distribution of all numerical variables
here.</p>
<pre class="r"><code># delete all the Na columns, and limit to countries with existing une_literacy data
data_2 &lt;- data %&gt;% 
  filter(is.na(une_literacy) == FALSE) %&gt;% 
  select(une_life, alcohol, bmi, measles, basic_water, che_gdp, une_gni, une_literacy, PM_value, income_group, percent_w_in_lower_house) %&gt;% 
  drop_na()</code></pre>
<pre class="r"><code>colname &lt;- c(&quot;alcohol&quot;, &quot;bmi&quot;, &quot;measles&quot;, &quot;basic_water&quot;, &quot;che_gdp&quot;, &quot;une_gni&quot;, &quot;une_literacy&quot;, &quot;PM_value&quot;, &quot;percent_w_in_lower_house&quot;)
par(mfrow=c(3, 3))
data_2_a &lt;- data.frame(data_2)
for (i in 1:9) {
  variable &lt;- data_2_a[colname[i]][ ,1]
  hist(variable, main = paste(&quot;Histogram of&quot;, colname[i], sep = &quot; &quot;), xlab = colname[i])
}</code></pre>
<p><img src="Linear_Regression_Model_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Delete all the NA rows in the data, consider intersection between
income_group and percent_w_in_lower_house, using step function with
backwards direction. Then we generate our second model.</p>
<pre class="r"><code># fit the model two
m &lt;- lm(une_life ~ alcohol + bmi + measles + basic_water + che_gdp + une_gni + une_literacy + PM_value + income_group * percent_w_in_lower_house, data = data_2)
# use stepwise function
m2 &lt;- step(m, direction = &quot;backward&quot;, trace = FALSE)</code></pre>
<pre class="r"><code># create table for regression output
m2 %&gt;%
  summary() %&gt;%
  broom::tidy() %&gt;%
  select(term, estimate, p.value) %&gt;% 
  knitr::kable(
      caption = &quot;Estimate and P-value of Model 2 for Year 2015 Life Expectancy Only in Countries With Existing Literacy Data&quot;, 
      col.names = c(&quot;Predictor&quot;, &quot;Estimate&quot;, &quot;P-value&quot;),
      digits = 3
  )</code></pre>
<table>
<caption>Estimate and P-value of Model 2 for Year 2015 Life Expectancy
Only in Countries With Existing Literacy Data</caption>
<thead>
<tr class="header">
<th align="left">Predictor</th>
<th align="right">Estimate</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">48.798</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">bmi</td>
<td align="right">-0.521</td>
<td align="right">0.126</td>
</tr>
<tr class="odd">
<td align="left">measles</td>
<td align="right">0.102</td>
<td align="right">0.100</td>
</tr>
<tr class="even">
<td align="left">basic_water</td>
<td align="right">0.185</td>
<td align="right">0.002</td>
</tr>
<tr class="odd">
<td align="left">che_gdp</td>
<td align="right">0.464</td>
<td align="right">0.088</td>
</tr>
<tr class="even">
<td align="left">income_groupHigh income</td>
<td align="right">13.186</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">income_groupLower middle income</td>
<td align="right">6.742</td>
<td align="right">0.005</td>
</tr>
<tr class="even">
<td align="left">income_groupUpper middle income</td>
<td align="right">8.695</td>
<td align="right">0.002</td>
</tr>
</tbody>
</table>
<p>From the above, variables like alcohol, une_gni, une_literacy,
PM_value, income_group:percent_w_in_lower_houseare,
percent_w_in_lower_houseare are deleted according to backwards step
function. It is very different from the model 1 when we limit to 37
countries. Moreover, even though we specifically make sure every country
has literacy data, literacy is not significant enough to be included in
the linear regression model.</p>
<p>The intersection of income group and women in
parliament(percent_w_in_lower_house) is also been deleted. Therefore, we
can conclude that the model we generate in a small range of countries
with complete literacy data entries is very different from the model
generated from a larger dataset, while literacy data is not significant
in the small range of countries. To conclude, we should discard literacy
variable, and also discard model 2.</p>
<p>The model 2’s R-adjusted score reaches 0.857607. This is reasonable,
since we generate model 2 in a small range of countries.</p>
<ul>
<li>Therefore, we should discard literacy variable, and also discard
model 2. We should consider Model 1 as a great subset of the full
model.</li>
</ul>
</div>
<div id="compare-model-1-with-full-model" class="section level1">
<h1>Compare Model 1 with Full Model</h1>
<p>Full Model is the Year 2015 full dataset except mortality rate and
except variables with more than 5% NAs.</p>
<ul>
<li>Full Model: uni_life ~ hepatitis + polio + diphtheria +
age5_19thinness + age5_19obesity + une_pop + alcohol + bmi + measles +
basic_water + gghe_d + che_gdp + une_pop + une_gni + PM_value +
income_group + percent_w_in_lower_house + Developed/Developing
Countries</li>
</ul>
<pre class="r"><code># generate the Year 2015 full dataset except mortality rate
data_full &lt;-
  read_csv(&quot;data/Merged_expectation.csv&quot;) %&gt;% 
  filter(year == 2015) %&gt;% 
  select(une_life, hepatitis, polio, diphtheria, age5_19thinness, age5_19obesity, une_pop , alcohol, bmi, measles, basic_water, gghe_d, che_gdp, une_pop, une_gni, PM_value, income_group, percent_w_in_lower_house, `Developed / Developing Countries`) %&gt;%
  drop_na()
m_full &lt;- lm(une_life ~ ., data = data_full)</code></pre>
<pre class="r"><code>m1 %&gt;%
  summary() %&gt;% 
  broom::glance() %&gt;%
  bind_rows(summary(m_full) %&gt;% broom::glance()) %&gt;%
  mutate(model = c(&quot;Model 1&quot;, &quot;Full Model&quot;)) %&gt;%
  select(model, everything()) %&gt;% 
  knitr::kable(
      caption = &quot;Comparision of Model 1 and Full Model&quot;, 
      digits = 3
  )</code></pre>
<table>
<caption>Comparision of Model 1 and Full Model</caption>
<colgroup>
<col width="13%" />
<col width="12%" />
<col width="17%" />
<col width="7%" />
<col width="12%" />
<col width="10%" />
<col width="3%" />
<col width="15%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">sigma</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">df</th>
<th align="right">df.residual</th>
<th align="right">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Model 1</td>
<td align="right">0.794</td>
<td align="right">0.781</td>
<td align="right">3.693</td>
<td align="right">59.777</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">155</td>
<td align="right">166</td>
</tr>
<tr class="even">
<td align="left">Full Model</td>
<td align="right">0.817</td>
<td align="right">0.791</td>
<td align="right">3.541</td>
<td align="right">31.710</td>
<td align="right">0</td>
<td align="right">19</td>
<td align="right">135</td>
<td align="right">155</td>
</tr>
</tbody>
</table>
<p>From the above table, Model 1 and Full Model do not have big
difference on adjusted R^2, but Model 1 has less predictors, which is
much better.</p>
</div>
<div id="transformation-on-response-variable-of-model-1"
class="section level1">
<h1>Transformation on Response Variable of Model 1</h1>
<p>First, we want to find whether response variable une_life needs
transformation.</p>
<pre class="r"><code>inverseResponsePlot(m1, key = TRUE)</code></pre>
<p><img src="Linear_Regression_Model_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre><code>##     lambda      RSS
## 1  2.17794 1637.306
## 2 -1.00000 1953.745
## 3  0.00000 1782.892
## 4  1.00000 1678.616</code></pre>
<p>From the above plot, the best <span
class="math inline">\(\lambda\)</span> for model 1 is 2.17794, which is
different from 1. Therefore, we will apply <span
class="math inline">\(\lambda\)</span> equal to 2.17794 to une_life.</p>
<pre class="r"><code># Fit model 1 with une_life^2.17794
m1_tr &lt;- lm((une_life)^2.17794 ~ alcohol + measles + basic_water + income_group * percent_w_in_lower_house, data = data_1)
# create table for regression output
m1_tr %&gt;%
  summary() %&gt;%
  broom::tidy() %&gt;%
  select(term, estimate, p.value) %&gt;% 
  knitr::kable(
      caption = &quot;Estimate and P-value of Transformed Model 1 for Year 2015 Life Expectancy&quot;, 
      col.names = c(&quot;Predictor&quot;, &quot;Estimate&quot;, &quot;P-value&quot;),
      digits = 3
  )</code></pre>
<table>
<caption>Estimate and P-value of Transformed Model 1 for Year 2015 Life
Expectancy</caption>
<colgroup>
<col width="77%" />
<col width="12%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Predictor</th>
<th align="right">Estimate</th>
<th align="right">P-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">695.168</td>
<td align="right">0.403</td>
</tr>
<tr class="even">
<td align="left">alcohol</td>
<td align="right">-52.404</td>
<td align="right">0.099</td>
</tr>
<tr class="odd">
<td align="left">measles</td>
<td align="right">19.506</td>
<td align="right">0.047</td>
</tr>
<tr class="even">
<td align="left">basic_water</td>
<td align="right">82.789</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">income_groupHigh income</td>
<td align="right">1960.037</td>
<td align="right">0.011</td>
</tr>
<tr class="even">
<td align="left">income_groupLower middle income</td>
<td align="right">942.528</td>
<td align="right">0.112</td>
</tr>
<tr class="odd">
<td align="left">income_groupUpper middle income</td>
<td align="right">1248.515</td>
<td align="right">0.093</td>
</tr>
<tr class="even">
<td align="left">percent_w_in_lower_house</td>
<td align="right">43.753</td>
<td align="right">0.025</td>
</tr>
<tr class="odd">
<td align="left">income_groupHigh income:percent_w_in_lower_house</td>
<td align="right">12.999</td>
<td align="right">0.603</td>
</tr>
<tr class="even">
<td align="left">income_groupLower middle
income:percent_w_in_lower_house</td>
<td align="right">-42.804</td>
<td align="right">0.065</td>
</tr>
<tr class="odd">
<td align="left">income_groupUpper middle
income:percent_w_in_lower_house</td>
<td align="right">-41.973</td>
<td align="right">0.091</td>
</tr>
</tbody>
</table>
<p>The transformed model 1’s R-adjusted score reaches 0.7886281. The
adjusted R square increases ~0.01 after transformation, which is close
to the adjusted R square of the full model. However, while the
difference of adjusted R square is small, for better interpretation, we
decide to choose the original Model 1.</p>
<p>Finally, our linear regression model on life expectancy is une_life ~
alcohol + measles + basic_water + income_group *
percent_w_in_lower_house.</p>
</div>
<div id="cross-validation" class="section level1">
<h1>Cross Validation</h1>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
